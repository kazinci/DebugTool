# DebugTool

DebugTool is an additional software for JTAG (Boundary Scan) testers used in Electronics Manufacturing to help find root cause of failed units.

# Summary

DebugTool consists of two parts:

* Server - Collects important files which are generated by the Test Machine.
* Client - Helps to find relevant files easier and much quicker than just searching between them manually.

# Detailed Description

## 1.	How GIFTS works?

GIFTS (Gilat Interface For Test Stand) in standby waiting for entering SN (Serial Number), MAC, PN (Part Number).
![GIFTS Screenshot](https://cloud.githubusercontent.com/assets/10960236/6703891/47fac7e8-cd4a-11e4-9e06-74fcd70fae1d.png)

When it’s entered, it will do the following things:

*	Save the entered information to the registry (HKEY_CURRENT_USER\Software\Gilat Satellite Networks Ltd.\SEII_JTAG\Serials):

![Registry Screenshot](https://cloud.githubusercontent.com/assets/10960236/6703997/c5eaed44-cd4b-11e4-96f3-3eb61d997275.png)
* Create a temporary file in Temp (C:\Documents and Settings\Administrator\Local Settings\Temp\GiftsResults.tmp)

![TempFile Screenshot](https://cloud.githubusercontent.com/assets/10960236/6704000/c5eb96cc-cd4b-11e4-8c06-060eae18a960.png)

*	If a board fails for example at “uSD_Detection” test, it will create an “uSD_Detection.err” file in C:\projects\622020\uSD_Detection\uSD_Detection\uSD_Detection.err (if the PN was 622020). So for every PN, for every test-step we will have separate “.err” files.

*	When the test-cycle ends (no matter the board failed or passed) GIFTS will not delete neither the GiftsResults.tmp, nor the information from registry. It ensures that after the test it can safely send test-results to the database.

*	If another test-cycle started then GiftsResults.tmp will be deleted immediately, and after a few seconds a new GiftsResults.tmp will be created, registry information, ERROR files will be overwritten (no matter that the board failed or passed), so every previous information will be lost.

## 2.	Why ERROR files are useful?
To understand it, let me open one of them (LAN_SW.err):

- - -

>01 SYNTAX_VERSION 1.3   
>02 DESIGN  DC405620   
>03 TEST    CLUST     
>04     
>05 INPUT_FILES   
>06 GEN_FILE "LAN_SW.gen"   
>07 APL_FILE "LAN_SW.apl"    
>08 CNN_FILE "LAN_SW.cnn"    
>09 END_INPUT_FILES   
>10    
>11 ERRORS 1   
>12                       
>13 VECTOR 282    TAP1  U19_dc622020_1  304   
>14 END_ERRORS    

 - - -
 
What is interesting for us it’s the 13.line. It describes where exactly the failures were happened (on which circuit-tracks). As you know vectors are oriented lines, they have a start and an end point, in our case the start point is 282, the end point is 304:

![Vector Screenshot](https://cloud.githubusercontent.com/assets/10960236/6704001/c5ebfa68-cd4b-11e4-999c-65dbcc25e960.png)

But what these numbers are means? The description for these points can be found in the “APL file” (in the same directory, near the ERROR file), which is in our case is LAN_SW.apl (I only show the two points, because the file is very big):


- - -

>...    
>92 MII_MDC                           AB  TAP1  U19_dc622020_1   282  W  AJ21; ! row,column = 1,1   
>...    
>95 MII_1[9]                          AB  TAP1  U19_dc622020_1   304  R  AG22; ! row,column = 1,3   
>...    
  

 - - -
 
 Analyzing the first row:
* MII_MDC - It’s the name of the circuit track:
![U19 Screenshot](https://cloud.githubusercontent.com/assets/10960236/6703999/c5eb532e-cd4b-11e4-88aa-df619e4d77dd.png)

* AB  TAP1 - Tester related information
* U19 - The component which was tested
* dc622020 - Part-number or Product-family (the directory name, where these files are located)
* 282 - Our vector’s start point
* W - Tester related information
* AJ21 - The component’s pin
* row,column = 1,1 - Tester related information
Analyzing the second row:
* MII_1[9] - It’s the name of the circuit track:
* ![U19 Screenshot2](https://cloud.githubusercontent.com/assets/10960236/6704002/c5ec02a6-cd4b-11e4-8763-fe2836d0b946.png)
* AB  TAP1 - Tester related information
* U19 - The component which was tested
* dc622020 - Part-number or Product-family (the directory name, where these files are located)
* 304 - Our vector’s end point
* R - Tester related information
* AG22 - The component’s pin
* row,column = 1,3 - Tester related information
* 
In one word the tester tries to send something through the “vector”, from U19 (AJ21) to U19 (AG22), but it fails for some reasons.
When a board fails, you only see that it failed on LAN_SW, but all the above information remains hidden.


## 3.	Debug Tool - Server Side

If we want to prevent these files to be overwritten, we need to periodically backup them. 
When the program is started it will do the following things:
  1.	Find all “.err” files in sourceDir1 (usually it’s C:\boards) and save them in an array with their last modified time.    
  2.	Find all “.err” files in sourceDir2 (usually it’s C:\projects) and append to the previous array with their last modified time. Thus we will get one big array with all error files in both directories.    
  3.	Get the screen size (width and height) – it’s needed because from there calculated where the “Show Log” button in GIFTS is.     
  4.	Computer name - it’s needed, because it will help to identify on which machine failed the board.     
  5.	Minimize to tray – it will prevent the program from accidental closing.    
  6.	Starting the “cycle” (by default in every 5secs, but it’s modifiable through settings)    
    6.1.	Checking if this file exists: "C:\Documents and Settings\Administrator\Local Settings\Temp\GiftsResults.tmp". It’s the file which is created every time, when a board tested. When a new test started – it’s deleted, and a new one will be created.     
      6.1.1. If the file exists, then copy it to "C:\GiftsResults.tmp". (must be copied periodically, because the original file is used by GIFTS)     
        6.1.2.	 Open the copied file, and check if it contains “Result=0” (which means, that the board failed)     
        6.1.3. When we know that it failed, the program will save the related log- and error file.      
          6.1.3.1.	Saving the log file happens by sending the following keystrokes programmatically: 

          • Click on “Show Log” button inside GIFTS. (Position calculated from the screen size).   
          • [Alt+F] = File menu point.     
          • [ENTER] = The first item is “Save”, so ENTER will activate it.     
          • SEND “SN.log” as filename, where “SN” is the Serial Number from registry.     
          • [TAB]*6 + [↓]*2 + [ENTER] = navigating to the Documents folder.     
          • [TAB]*2 + [Alt+S] = Saving the Log file.    
          • [Alt+F4] = Closing the Log window.     

When it is saved, it will contain all LOG information from previous boards, so we have to extract from there only the related info by searching for the last “Start testing iteration” row inside the file and only save this part. 
When the new log file is created, the program will attempt to copy it as SN_0.log to the server. If there is already a file with the same name, then will be renamed to SN_1.log, and it will be repeated until the file can be copied successfully (it will prevent overwriting and ensures the possibility to track the multi-failing of a board).
The program saves all LOG files to \\192.168.150.2\c$\ERR_FILES\LOG\.     
          6.1.3.2.	Saving the ERROR files happens by checking all the ERROR files in both directories if they modified from the last time.      
If one of them modified, the program will open it and search for "ERRORS"(it will ensure that only those ERROR files will be copied which are really contains errors).     
If the file contains error(s), the program will attempt to copy it as originalFileName_0.log to the server. If there is already a file with the same name, then will be renamed to originalFileName_1.log, and it will be repeated until the file can be copied successfully (it will prevent overwriting and ensures the possibility to track the multi-failing of a board).       
The program saves all ERROR files preserving the original directory structure on the server, for example \\192.168.150.2\c$\ERR_FILES\projects\622020\Inter\Inter\SN_0-inter.err (where SN is the Serial Number of the board, 622020 is the Part Number, Inter the failure)     
      6.1.4.	  Stop the continuous copying of GiftsResults.tmp.    
    6.2.	If the GiftsResults.tmp not exists it means that a new test-cycle started in GIFTS, so it is a “trigger” which restarts the whole procedure.       
7.	The “cycle” can be stopped either by clicking on [Stop] button, or by closing the program.
As a result, we will get the following file-structure:

![Diagram](https://cloud.githubusercontent.com/assets/10960236/6703998/c5eb2a16-cd4b-11e4-8cf9-509d84b7b77d.png)


### 3.1.	The GUI

### 3.1.1. Main window:

![Gui](https://cloud.githubusercontent.com/assets/10960236/6704003/c603ad84-cd4b-11e4-9b35-f9733ca5ab1c.png)

[Start] - Starts the cycle. When the program loaded it’s activated automatically.     
[Stop]- Stops the cycle. The program will be idle.      
[Copy APL files]- Copy all “*.apl” files to the server (preserving the original directory structure). It’s needed for the Client.     
[Menu]- From there can be open the “Settings” window.     

### 3.1.2.	Settings window:

![Settings](https://cloud.githubusercontent.com/assets/10960236/6704006/c6084ac4-cd4b-11e4-8025-58ea7f1d239c.png)

[Backup Folder]- The backup-folder, where all LOG and ERROR files will be saved.    
[1st Folder]- Usually ERROR files are in two different directories. Here you can set the first folder.    
[2nd Folder]- Second folder with ERROR files    
[Check Interval] - Here you can modify how frequently will be scanned the Temp-folder for GiftsResults.tmp    
[Use log]- The program stores debug information (program starting/stopping, which file copied, etc.) to C:\debug_tool.log. Here you can disable it.     
[Auto-click+Copy]- Saving board’s LOG files can be switched off. Only ERROR files will be saved in this case.    


## 4.	Debug Tool - Client Side

The client-side of the program collects the failed board’s related information (LOG and ERROR files). You can also achieve this through browsing these files in Windows Explorer, but it’s very time-consuming if there are a lot of files.    

### 4.1.	The GUI

#### 4.1.1.	Main Page

![Settings](https://cloud.githubusercontent.com/assets/10960236/6704005/c607ee6c-cd4b-11e4-9ab1-ec07c2dcd7cf.png)

- Enter here the Serial-number of the board    
- Click on [Search!] if the searching doesn’t started automatically. The program will load all the related LOG files (how many LOG file see here means how many times failed the board)     
- Double clicking on the selected item will open the [Select error] page, where you can find the related failures    
- Here is the location, where these files are located. You can copy it if you need it.    
-  This opens the address from ④ in Windows Explorer.   

#### 4.1.2.	Select error Page:

![Settings](https://cloud.githubusercontent.com/assets/10960236/6704004/c60751aa-cd4b-11e4-9090-56876027225b.png)

- Double clicking on the selected item will open the [Show error] page, where you can find the extracted ERROR and APL files.    
- This shows the original LOG file.     

#### 4.1.3.	Show error Page:

![Settings](https://cloud.githubusercontent.com/assets/10960236/6704007/c609f306-cd4b-11e4-83d7-1e9a541a5539.png)

- By selecting a vector the program automatically finds the start/end points and will search these in the related APL file     
- This shows the original ERROR file.    
- Here is the “start point” of the vector.    
- This shows the original APL file.     
- Here is the “end point” of the vector.    


#### 4.1.4.	Cook Book Page:

![Settings](https://cloud.githubusercontent.com/assets/10960236/6704008/c60a6584-cd4b-11e4-9b4e-7067abca28b1.png)

- Here you can verify to which PN and Failure are you sending Cook book information.     
- Enter the component’s name, debug & repair information, etc. – anything what can help you next time when you meets with the same failure.    
- Clicking on the button will send the Cook Book information and update the below table    
- Overview of the previously entered information (Cook Book).    
